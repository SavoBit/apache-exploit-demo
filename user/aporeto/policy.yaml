APIVersion: 0
data:
  auditprofiles: []
  externalnetworks:
    - annotations: {}
      associatedTags:
        - 'legacy:ipacl=dns'
      description: ''
      entries:
        - 0.0.0.0/0
      metadata: []
      name: DNS
      ports:
        - '53'
      protected: false
      protocols:
        - udp
  isolationprofiles:
    - annotations: {}
      associatedTags:
        - internet_facing=true
      capabilitiesActions: {}
      defaultSyscallAction: 0
      description: ''
      metadata: []
      name: Apache Struts
      protected: false
      syscallRules:
        clone:
          action: 0
          args: []
        execve:
          action: 0
          args: []
        fork:
          action: 0
          args: []
      targetArchitectures:
        - x86
  networkaccesspolicies:
    - action: Allow
      activeDuration: ''
      activeSchedule: ''
      annotations: {}
      applyPolicyMode: Bidirectional
      associatedTags: []
      description: ''
      destinationPorts: []
      disabled: false
      encryptionEnabled: false
      fallback: false
      logsEnabled: true
      metadata: []
      name: Client to Server
      negateObject: false
      negateSubject: false
      object:
        - - role=server
      observationEnabled: false
      observedTrafficAction: Continue
      propagate: false
      protected: false
      subject:
        - - role=client
    - action: Allow
      activeDuration: ''
      activeSchedule: ''
      annotations: {}
      applyPolicyMode: Bidirectional
      associatedTags: []
      description: ''
      destinationPorts: []
      disabled: false
      encryptionEnabled: false
      fallback: false
      logsEnabled: true
      metadata: []
      name: DNS Resolver
      negateObject: false
      negateSubject: false
      object:
        - - 'legacy:ipacl=dns'
      observationEnabled: false
      observedTrafficAction: Continue
      propagate: false
      protected: false
      subject:
        - - $identity=processingunit
    - action: Allow
      activeDuration: ''
      activeSchedule: ''
      annotations: {}
      applyPolicyMode: Bidirectional
      associatedTags: []
      description: ''
      destinationPorts: []
      disabled: false
      encryptionEnabled: false
      fallback: false
      logsEnabled: true
      metadata: []
      name: Server to Evil Controller
      negateObject: false
      negateSubject: false
      object:
        - - role=controller
      observationEnabled: false
      observedTrafficAction: Continue
      propagate: false
      protected: false
      subject:
        - - role=server
identities:
  - auditprofile
  - externalnetwork
  - isolationprofile
  - networkaccesspolicy
label: Apache Struts Demo Default
